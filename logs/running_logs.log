[2026-02-15 23:55:23,688: INFO: main: Welcome to our custom logger]
[2026-02-20 00:06:46,987: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2026-02-20 00:06:47,021: INFO: common: yaml file: config\config.yaml loaded successfully]
[2026-02-20 00:06:47,051: INFO: common: yaml file: params.yaml loaded successfully]
[2026-02-20 00:06:47,053: INFO: common: created directory at: artifacts]
[2026-02-20 00:06:47,053: INFO: common: created directory at: artifacts/data_ingestion]
[2026-02-20 00:06:47,055: INFO: data_ingestion: Downloading data from https://drive.google.com/file/d/1-0aZuQfEkJqCR4Wnuwuv6pmI5QAJZYm6/view?usp=sharing into file artifacts/data_ingestion/data.zip]
[2026-02-20 00:09:24,471: INFO: data_ingestion: Downloaded data from https://drive.google.com/file/d/1-0aZuQfEkJqCR4Wnuwuv6pmI5QAJZYm6/view?usp=sharing into file artifacts/data_ingestion/data.zip]
[2026-02-20 00:10:18,405: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x==========x]
[2026-02-20 23:58:39,683: INFO: common: yaml file: config\config.yaml loaded successfully]
[2026-02-20 23:58:39,734: INFO: common: yaml file: params.yaml loaded successfully]
[2026-02-20 23:58:39,746: INFO: common: created directory at: artifacts]
[2026-02-20 23:58:39,750: INFO: common: created directory at: artifacts/prepare_base_model]
[2026-02-20 23:58:49,248: WARNING: saving_utils: Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.]
[2026-02-21 00:08:30,751: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2026-02-21 00:08:30,758: INFO: common: yaml file: config\config.yaml loaded successfully]
[2026-02-21 00:08:30,763: INFO: common: yaml file: params.yaml loaded successfully]
[2026-02-21 00:08:30,765: INFO: common: created directory at: artifacts]
[2026-02-21 00:08:30,765: INFO: common: created directory at: artifacts/data_ingestion]
[2026-02-21 00:08:30,765: INFO: data_ingestion: Downloading data from https://drive.google.com/file/d/1-0aZuQfEkJqCR4Wnuwuv6pmI5QAJZYm6/view?usp=sharing into file artifacts/data_ingestion/data.zip]
[2026-02-21 00:10:03,924: INFO: data_ingestion: Downloaded data from https://drive.google.com/file/d/1-0aZuQfEkJqCR4Wnuwuv6pmI5QAJZYm6/view?usp=sharing into file artifacts/data_ingestion/data.zip]
[2026-02-21 00:10:58,212: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x==========x]
[2026-02-21 00:15:27,358: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2026-02-21 00:15:27,364: INFO: common: yaml file: config\config.yaml loaded successfully]
[2026-02-21 00:15:27,369: INFO: common: yaml file: params.yaml loaded successfully]
[2026-02-21 00:15:27,369: INFO: common: created directory at: artifacts]
[2026-02-21 00:15:27,369: INFO: common: created directory at: artifacts/data_ingestion]
[2026-02-21 00:15:27,369: INFO: data_ingestion: Downloading data from https://drive.google.com/file/d/1-0aZuQfEkJqCR4Wnuwuv6pmI5QAJZYm6/view?usp=sharing into file artifacts/data_ingestion/data.zip]
[2026-02-21 00:16:51,102: INFO: data_ingestion: Downloaded data from https://drive.google.com/file/d/1-0aZuQfEkJqCR4Wnuwuv6pmI5QAJZYm6/view?usp=sharing into file artifacts/data_ingestion/data.zip]
[2026-02-21 00:17:21,740: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x==========x]
[2026-02-21 00:17:21,740: INFO: main: *******************]
[2026-02-21 00:17:21,740: INFO: main: >>>>>> stage Prepare base model started <<<<<<]
[2026-02-21 00:17:21,744: INFO: common: yaml file: config\config.yaml loaded successfully]
[2026-02-21 00:17:21,748: INFO: common: yaml file: params.yaml loaded successfully]
[2026-02-21 00:17:21,748: INFO: common: created directory at: artifacts]
[2026-02-21 00:17:21,750: INFO: common: created directory at: artifacts/prepare_base_model]
[2026-02-21 00:17:24,621: WARNING: saving_utils: Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.]
[2026-02-21 00:17:32,707: INFO: main: >>>>>> stage Prepare base model completed <<<<<<

x==========x]
[2026-02-21 00:17:32,707: INFO: main: *******************]
[2026-02-21 00:17:32,707: INFO: main: >>>>>> stage Training started <<<<<<]
[2026-02-21 00:17:32,707: ERROR: main: name 'ModelTrainingPipeline' is not defined]
Traceback (most recent call last):
  File "C:\Users\kushagra\Kidney-Disease_Classification-MLflow-DVC\main.py", line 40, in <module>
    model_trainer = ModelTrainingPipeline()
NameError: name 'ModelTrainingPipeline' is not defined
[2026-02-21 16:22:52,145: INFO: common: yaml file: config\config.yaml loaded successfully]
[2026-02-21 16:22:52,194: INFO: common: yaml file: params.yaml loaded successfully]
[2026-02-21 16:22:52,203: INFO: common: created directory at: artifacts]
[2026-02-21 16:22:52,209: INFO: common: created directory at: artifacts\training]
[2026-02-21 16:28:40,902: INFO: common: yaml file: config\config.yaml loaded successfully]
[2026-02-21 16:28:40,924: INFO: common: yaml file: params.yaml loaded successfully]
[2026-02-21 16:28:40,932: INFO: common: created directory at: artifacts]
[2026-02-21 16:28:40,939: INFO: common: created directory at: artifacts\training]
[2026-02-21 16:30:09,999: INFO: common: yaml file: config\config.yaml loaded successfully]
[2026-02-21 16:30:10,010: INFO: common: yaml file: params.yaml loaded successfully]
[2026-02-21 16:30:10,013: INFO: common: created directory at: artifacts]
[2026-02-21 16:30:10,018: INFO: common: created directory at: artifacts\training]
[2026-02-21 16:36:27,821: INFO: common: yaml file: config\config.yaml loaded successfully]
[2026-02-21 16:36:27,847: INFO: common: yaml file: params.yaml loaded successfully]
[2026-02-21 16:36:27,857: INFO: common: created directory at: artifacts]
[2026-02-21 16:36:27,861: INFO: common: created directory at: artifacts\training]
[2026-02-21 16:37:33,780: INFO: common: yaml file: config\config.yaml loaded successfully]
[2026-02-21 16:37:33,780: INFO: common: yaml file: params.yaml loaded successfully]
[2026-02-21 16:37:33,789: INFO: common: created directory at: artifacts]
[2026-02-21 16:37:33,789: INFO: common: created directory at: artifacts\training]
[2026-02-22 09:59:17,670: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2026-02-22 09:59:17,677: INFO: common: yaml file: config\config.yaml loaded successfully]
[2026-02-22 09:59:17,685: INFO: common: yaml file: params.yaml loaded successfully]
[2026-02-22 09:59:17,685: INFO: common: created directory at: artifacts]
[2026-02-22 09:59:17,685: INFO: common: created directory at: artifacts/data_ingestion]
[2026-02-22 09:59:17,693: INFO: data_ingestion: Downloading data from https://drive.google.com/file/d/1-0aZuQfEkJqCR4Wnuwuv6pmI5QAJZYm6/view?usp=sharing into file artifacts/data_ingestion/data.zip]
[2026-02-22 10:00:41,847: INFO: data_ingestion: Downloaded data from https://drive.google.com/file/d/1-0aZuQfEkJqCR4Wnuwuv6pmI5QAJZYm6/view?usp=sharing into file artifacts/data_ingestion/data.zip]
[2026-02-22 10:01:51,259: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x==========x]
[2026-02-22 10:01:51,259: INFO: main: *******************]
[2026-02-22 10:01:51,261: INFO: main: >>>>>> stage Prepare base model started <<<<<<]
[2026-02-22 10:01:51,268: INFO: common: yaml file: config\config.yaml loaded successfully]
[2026-02-22 10:01:51,271: INFO: common: yaml file: params.yaml loaded successfully]
[2026-02-22 10:01:51,271: INFO: common: created directory at: artifacts]
[2026-02-22 10:01:51,271: INFO: common: created directory at: artifacts/prepare_base_model]
[2026-02-22 10:01:52,466: WARNING: saving_utils: Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.]
[2026-02-22 10:01:52,966: INFO: main: >>>>>> stage Prepare base model completed <<<<<<

x==========x]
[2026-02-22 10:01:52,966: INFO: main: *******************]
[2026-02-22 10:01:52,966: INFO: main: >>>>>> stage Training started <<<<<<]
[2026-02-22 10:01:52,971: INFO: common: yaml file: config\config.yaml loaded successfully]
[2026-02-22 10:01:52,977: INFO: common: yaml file: params.yaml loaded successfully]
[2026-02-22 10:01:52,978: INFO: common: created directory at: artifacts]
[2026-02-22 10:01:52,981: INFO: common: created directory at: artifacts\training]
[2026-02-22 10:02:03,194: ERROR: main: Graph execution error:

Detected at node 'categorical_crossentropy/softmax_cross_entropy_with_logits' defined at (most recent call last):
    File "C:\Users\kushagra\Kidney-Disease_Classification-MLflow-DVC\main.py", line 41, in <module>
      model_trainer.main()
    File "C:\Users\kushagra\Kidney-Disease_Classification-MLflow-DVC\src\cnnClassifier\pipeline\stage_03_model_training.py", line 22, in main
      training.train()
    File "C:\Users\kushagra\Kidney-Disease_Classification-MLflow-DVC\src\cnnClassifier\components\model_training.py", line 76, in train
      self.model.fit(
    File "D:\anoconda3\envs\kidney\lib\site-packages\keras\utils\traceback_utils.py", line 65, in error_handler
      return fn(*args, **kwargs)
    File "D:\anoconda3\envs\kidney\lib\site-packages\keras\engine\training.py", line 1685, in fit
      tmp_logs = self.train_function(iterator)
    File "D:\anoconda3\envs\kidney\lib\site-packages\keras\engine\training.py", line 1284, in train_function
      return step_function(self, iterator)
    File "D:\anoconda3\envs\kidney\lib\site-packages\keras\engine\training.py", line 1268, in step_function
      outputs = model.distribute_strategy.run(run_step, args=(data,))
    File "D:\anoconda3\envs\kidney\lib\site-packages\keras\engine\training.py", line 1249, in run_step
      outputs = model.train_step(data)
    File "D:\anoconda3\envs\kidney\lib\site-packages\keras\engine\training.py", line 1051, in train_step
      loss = self.compute_loss(x, y, y_pred, sample_weight)
    File "D:\anoconda3\envs\kidney\lib\site-packages\keras\engine\training.py", line 1109, in compute_loss
      return self.compiled_loss(
    File "D:\anoconda3\envs\kidney\lib\site-packages\keras\engine\compile_utils.py", line 265, in __call__
      loss_value = loss_obj(y_t, y_p, sample_weight=sw)
    File "D:\anoconda3\envs\kidney\lib\site-packages\keras\losses.py", line 142, in __call__
      losses = call_fn(y_true, y_pred)
    File "D:\anoconda3\envs\kidney\lib\site-packages\keras\losses.py", line 268, in call
      return ag_fn(y_true, y_pred, **self._fn_kwargs)
    File "D:\anoconda3\envs\kidney\lib\site-packages\keras\losses.py", line 1984, in categorical_crossentropy
      return backend.categorical_crossentropy(
    File "D:\anoconda3\envs\kidney\lib\site-packages\keras\backend.py", line 5565, in categorical_crossentropy
      return tf.nn.softmax_cross_entropy_with_logits(
Node: 'categorical_crossentropy/softmax_cross_entropy_with_logits'
logits and labels must be broadcastable: logits_size=[16,4] labels_size=[16,2]
	 [[{{node categorical_crossentropy/softmax_cross_entropy_with_logits}}]] [Op:__inference_train_function_1463]]
Traceback (most recent call last):
  File "C:\Users\kushagra\Kidney-Disease_Classification-MLflow-DVC\main.py", line 41, in <module>
    model_trainer.main()
  File "C:\Users\kushagra\Kidney-Disease_Classification-MLflow-DVC\src\cnnClassifier\pipeline\stage_03_model_training.py", line 22, in main
    training.train()
  File "C:\Users\kushagra\Kidney-Disease_Classification-MLflow-DVC\src\cnnClassifier\components\model_training.py", line 76, in train
    self.model.fit(
  File "D:\anoconda3\envs\kidney\lib\site-packages\keras\utils\traceback_utils.py", line 70, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "D:\anoconda3\envs\kidney\lib\site-packages\tensorflow\python\eager\execute.py", line 52, in quick_execute
    tensors = pywrap_tfe.TFE_Py_Execute(ctx._handle, device_name, op_name,
tensorflow.python.framework.errors_impl.InvalidArgumentError: Graph execution error:

Detected at node 'categorical_crossentropy/softmax_cross_entropy_with_logits' defined at (most recent call last):
    File "C:\Users\kushagra\Kidney-Disease_Classification-MLflow-DVC\main.py", line 41, in <module>
      model_trainer.main()
    File "C:\Users\kushagra\Kidney-Disease_Classification-MLflow-DVC\src\cnnClassifier\pipeline\stage_03_model_training.py", line 22, in main
      training.train()
    File "C:\Users\kushagra\Kidney-Disease_Classification-MLflow-DVC\src\cnnClassifier\components\model_training.py", line 76, in train
      self.model.fit(
    File "D:\anoconda3\envs\kidney\lib\site-packages\keras\utils\traceback_utils.py", line 65, in error_handler
      return fn(*args, **kwargs)
    File "D:\anoconda3\envs\kidney\lib\site-packages\keras\engine\training.py", line 1685, in fit
      tmp_logs = self.train_function(iterator)
    File "D:\anoconda3\envs\kidney\lib\site-packages\keras\engine\training.py", line 1284, in train_function
      return step_function(self, iterator)
    File "D:\anoconda3\envs\kidney\lib\site-packages\keras\engine\training.py", line 1268, in step_function
      outputs = model.distribute_strategy.run(run_step, args=(data,))
    File "D:\anoconda3\envs\kidney\lib\site-packages\keras\engine\training.py", line 1249, in run_step
      outputs = model.train_step(data)
    File "D:\anoconda3\envs\kidney\lib\site-packages\keras\engine\training.py", line 1051, in train_step
      loss = self.compute_loss(x, y, y_pred, sample_weight)
    File "D:\anoconda3\envs\kidney\lib\site-packages\keras\engine\training.py", line 1109, in compute_loss
      return self.compiled_loss(
    File "D:\anoconda3\envs\kidney\lib\site-packages\keras\engine\compile_utils.py", line 265, in __call__
      loss_value = loss_obj(y_t, y_p, sample_weight=sw)
    File "D:\anoconda3\envs\kidney\lib\site-packages\keras\losses.py", line 142, in __call__
      losses = call_fn(y_true, y_pred)
    File "D:\anoconda3\envs\kidney\lib\site-packages\keras\losses.py", line 268, in call
      return ag_fn(y_true, y_pred, **self._fn_kwargs)
    File "D:\anoconda3\envs\kidney\lib\site-packages\keras\losses.py", line 1984, in categorical_crossentropy
      return backend.categorical_crossentropy(
    File "D:\anoconda3\envs\kidney\lib\site-packages\keras\backend.py", line 5565, in categorical_crossentropy
      return tf.nn.softmax_cross_entropy_with_logits(
Node: 'categorical_crossentropy/softmax_cross_entropy_with_logits'
logits and labels must be broadcastable: logits_size=[16,4] labels_size=[16,2]
	 [[{{node categorical_crossentropy/softmax_cross_entropy_with_logits}}]] [Op:__inference_train_function_1463]
[2026-02-22 10:04:33,853: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2026-02-22 10:04:33,871: INFO: common: yaml file: config\config.yaml loaded successfully]
[2026-02-22 10:04:33,895: INFO: common: yaml file: params.yaml loaded successfully]
[2026-02-22 10:04:33,895: INFO: common: created directory at: artifacts]
[2026-02-22 10:04:33,906: INFO: common: created directory at: artifacts/data_ingestion]
[2026-02-22 10:04:33,910: INFO: data_ingestion: Downloading data from https://drive.google.com/file/d/1-0aZuQfEkJqCR4Wnuwuv6pmI5QAJZYm6/view?usp=sharing into file artifacts/data_ingestion/data.zip]
[2026-02-22 10:05:54,534: INFO: data_ingestion: Downloaded data from https://drive.google.com/file/d/1-0aZuQfEkJqCR4Wnuwuv6pmI5QAJZYm6/view?usp=sharing into file artifacts/data_ingestion/data.zip]
[2026-02-22 10:06:36,157: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x==========x]
[2026-02-22 10:06:36,159: INFO: main: *******************]
[2026-02-22 10:06:36,159: INFO: main: >>>>>> stage Prepare base model started <<<<<<]
[2026-02-22 10:06:36,165: INFO: common: yaml file: config\config.yaml loaded successfully]
[2026-02-22 10:06:36,169: INFO: common: yaml file: params.yaml loaded successfully]
[2026-02-22 10:06:36,169: INFO: common: created directory at: artifacts]
[2026-02-22 10:06:36,169: INFO: common: created directory at: artifacts/prepare_base_model]
[2026-02-22 10:06:37,309: WARNING: saving_utils: Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.]
[2026-02-22 10:06:37,820: INFO: main: >>>>>> stage Prepare base model completed <<<<<<

x==========x]
[2026-02-22 10:06:37,820: INFO: main: *******************]
[2026-02-22 10:06:37,820: INFO: main: >>>>>> stage Training started <<<<<<]
[2026-02-22 10:06:37,827: INFO: common: yaml file: config\config.yaml loaded successfully]
[2026-02-22 10:06:37,832: INFO: common: yaml file: params.yaml loaded successfully]
[2026-02-22 10:06:37,834: INFO: common: created directory at: artifacts]
[2026-02-22 10:06:37,834: INFO: common: created directory at: artifacts\training]
[2026-02-22 10:06:38,595: ERROR: main: [WinError 3] The system cannot find the path specified: 'artifacts\\data_ingestion\\kidney-ct-scan-image']
Traceback (most recent call last):
  File "C:\Users\kushagra\Kidney-Disease_Classification-MLflow-DVC\main.py", line 41, in <module>
    model_trainer.main()
  File "C:\Users\kushagra\Kidney-Disease_Classification-MLflow-DVC\src\cnnClassifier\pipeline\stage_03_model_training.py", line 21, in main
    training.train_valid_generator()
  File "C:\Users\kushagra\Kidney-Disease_Classification-MLflow-DVC\src\cnnClassifier\components\model_training.py", line 37, in train_valid_generator
    self.valid_generator = valid_datagenerator.flow_from_directory(
  File "D:\anoconda3\envs\kidney\lib\site-packages\keras\preprocessing\image.py", line 1648, in flow_from_directory
    return DirectoryIterator(
  File "D:\anoconda3\envs\kidney\lib\site-packages\keras\preprocessing\image.py", line 563, in __init__
    for subdir in sorted(os.listdir(directory)):
FileNotFoundError: [WinError 3] The system cannot find the path specified: 'artifacts\\data_ingestion\\kidney-ct-scan-image'
[2026-02-22 10:09:42,965: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2026-02-22 10:09:42,972: INFO: common: yaml file: config\config.yaml loaded successfully]
[2026-02-22 10:09:42,979: INFO: common: yaml file: params.yaml loaded successfully]
[2026-02-22 10:09:42,980: INFO: common: created directory at: artifacts]
[2026-02-22 10:09:42,980: INFO: common: created directory at: artifacts/data_ingestion]
[2026-02-22 10:09:42,980: INFO: data_ingestion: Downloading data from https://drive.google.com/file/d/1-0aZuQfEkJqCR4Wnuwuv6pmI5QAJZYm6/view?usp=sharing into file artifacts/data_ingestion/data.zip]
[2026-02-22 10:10:46,675: INFO: data_ingestion: Downloaded data from https://drive.google.com/file/d/1-0aZuQfEkJqCR4Wnuwuv6pmI5QAJZYm6/view?usp=sharing into file artifacts/data_ingestion/data.zip]
[2026-02-22 10:11:34,110: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x==========x]
[2026-02-22 10:11:34,114: INFO: main: *******************]
[2026-02-22 10:11:34,114: INFO: main: >>>>>> stage Prepare base model started <<<<<<]
[2026-02-22 10:11:34,120: INFO: common: yaml file: config\config.yaml loaded successfully]
[2026-02-22 10:11:34,122: INFO: common: yaml file: params.yaml loaded successfully]
[2026-02-22 10:11:34,122: INFO: common: created directory at: artifacts]
[2026-02-22 10:11:34,126: INFO: common: created directory at: artifacts/prepare_base_model]
[2026-02-22 10:11:35,252: WARNING: saving_utils: Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.]
[2026-02-22 10:11:35,773: INFO: main: >>>>>> stage Prepare base model completed <<<<<<

x==========x]
[2026-02-22 10:11:35,774: INFO: main: *******************]
[2026-02-22 10:11:35,774: INFO: main: >>>>>> stage Training started <<<<<<]
[2026-02-22 10:11:35,779: INFO: common: yaml file: config\config.yaml loaded successfully]
[2026-02-22 10:11:35,783: INFO: common: yaml file: params.yaml loaded successfully]
[2026-02-22 10:11:35,783: INFO: common: created directory at: artifacts]
[2026-02-22 10:11:35,786: INFO: common: created directory at: artifacts\training]
[2026-02-22 10:24:29,338: INFO: main: >>>>>> stage Training completed <<<<<<

x==========x]
[2026-02-22 10:24:29,338: INFO: main: *******************]
[2026-02-22 10:24:29,338: INFO: main: >>>>>> stage Evaluation stage started <<<<<<]
[2026-02-22 10:24:29,338: ERROR: main: name 'EvaluationPipeline' is not defined]
Traceback (most recent call last):
  File "C:\Users\kushagra\Kidney-Disease_Classification-MLflow-DVC\main.py", line 54, in <module>
    model_evalution = EvaluationPipeline()
NameError: name 'EvaluationPipeline' is not defined
